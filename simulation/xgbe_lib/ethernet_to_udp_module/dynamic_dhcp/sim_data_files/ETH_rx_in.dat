% comments:
% any line started with '%' - flag can be specified as generic in file_reader_hex
anything less than
length of a line
containing data
is also considered
as a comment

% interpreter ignores empty lines as well

% "@" is used to indicate counters for transmission start
% flag can be specified as generic in AV_ST_sender
% must be decimal numbers in increasing order!

% initially the Ethernet module is running with static IP configuration (using the default IP address)
%
% first we establish a connection from A3:C2:C7:00:12:32/C0.A8.03.61 (192.168.3.97)
% starting with an ARP request and a ping.

% ARP request by A3:C2:C7:00:12:32/C0.A8.03.61 (192.168.3.97)
@ 20
FFFF FFFF FFFF A3C2
C700 1232 0806 0001
0800 0604 0001 A3C2
C700 1232 C0A8 0361
FFFF FFFF FFFF C0A8

without error:
0002 0000 0000 0000
0000 0000 0000 0000
0000 0003 2100 0000 011 0

PING request:
@ 30
0022 8F02 41EE A3C2
C700 1232 0800 4500
003c 2f46 0000 8001
0000 c0a8 0361 c0a8
0002 0800 4d53 0001
0008 6162 6364 6566
6768 696a 6b6c 6d6e
6f70 7172 7374 7576
7761 6263 6465 6667
6869 0000 0000 0000 110 0

% IP packet: UDP data from port a191 to port 0001
@ 45
0022 8F02 41EE A3C2
C700 1232 0800 4500
001d 093c 4000 8011
0000 c0a8 0361 c0a8
0002 a191 0001 0044

0000 0809 1011 1213
1234 1234 1234 1234
2345 2345 2345 2345
3456 3456 3456 3456
4567 4567 4567 4567
5678 5678 5678 5678
6789 6789 6789 6789
7890 7890 7890 7890 100 0

% counter check: ARP request and PING to another IP address (i.e. the one it would get DHCP-ed later...)
% we expect no answer from that

% ARP request by A3:C2:C7:00:12:32/C0.A8.03.61 (192.168.3.97)
@ 120
FFFF FFFF FFFF A3C2
C700 1232 0806 0001
0800 0604 0001 A3C2
C700 1232 C0A8 0361
FFFF FFFF FFFF C0A8

without error:
001E 0000 0000 0000
0000 0000 0000 0000
0000 0003 2100 0000 011 0

PING request:
@ 130
0022 8F02 41EE A3C2
C700 1232 0800 4500
003c 2f46 0000 8001
0000 c0a8 0361 c0a8
001e 0800 4d53 0001
0008 6162 6364 6566
6768 696a 6b6c 6d6e
6f70 7172 7374 7576
7761 6263 6465 6667
6869 0000 0000 0000 110 0

% IP packet: UDP data from port a191 to port 0001
@ 145
0022 8F02 41EE A3C2
C700 1232 0800 4500
001d 093c 4000 8011
0000 c0a8 0361 c0a8
001e a191 0001 0044

0000 0809 1011 1213
1234 1234 1234 1234
2345 2345 2345 2345
3456 3456 3456 3456
4567 4567 4567 4567
5678 5678 5678 5678
6789 6789 6789 6789
7890 7890 7890 7890 100 0


% that's enough for a simple test in this testbench and we assume the DHCP enable switch to go on now
% we hence go through a bit of DHCP configuration (shortest possible way: offer and acknowledge)
% more complicated scenarios are tested in the default test bench

% DHCP Offer (35*8+6 bytes long = 286 = x11E) of IP C0.A8.00.1D (192.168.0.29)
@ 300
% Ethernet header
% DST MAC, SCR MAC
0022 8F02 41EE 0123
% ....... protocol, IP header
4567 89AB 0800 4500
% IP header (continued)
001D 093C 4000 8011
% ............ UDP header
0000 C0A8 0101 FFFF
% SRC DST length CRC
FFFF 0043 0044 011F
% ............ DHCP header
0000 0201 0600 DEAD
% XID SECS FLAGS
BEEF 0000 0000 0000
% CIADDR YIADDR
0000 C0A8 001E C0A8
% SIADDR GIADDR
0101 0000 0000 0022
% CHADDR(1)
8F02 41EE 0000 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% ............ MAGIC_COOKIE
0000 0000 0000 6382
% .. DHCP offer (3 + 1)
5363 3501 0200 0104
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
FFFF 0000 0304 C0A8
% IP lease time (6)
0101 3304 0001 5180
% DHCP server (6)
3604 C0A8 0101 0608
% DNS server (10)
0102 0304 0102 0305
FFBA DBAD BADD 0000 111 0

% DHCP Acknowledge
@ 500
% Ethernet header
% DST MAC, SCR MAC
0022 8F02 41EE 0123
% ....... protocol, IP header
4567 89AB 0800 4500
% IP header (continued)
001D 093C 4000 8011
% ............ UDP header
0000 C0A8 0101 FFFF
% SRC DST length CRC
FFFF 0043 0044 011F
0000 0201 0600 DEAD
% DHCP-header XID SECS FLAGS
BEEF 0000 0000 0000
% CIADDR YIADDR
0000 C0A8 001E C0A8
% SIADDR GIADDR
0101 0000 0000 0022
% CHADDR(1)
8F02 41EE 0000 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 6382
% MAGIC_COOKIE DHCP ackn (3 + 1)
5363 3501 0500 0104
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
FFFF 0000 0304 C0A8
% IP lease time (6)
0101 3304 0000 0050
% DHCP server (6)
3604 C0A8 0101 0608
% DNS server (10)
0102 0304 0102 0305
FFBA DBAD BADD BADD 111 0

% now we are configured with a proper IP address and some further testing can begin

% ARP request by A3:C2:C7:00:12:32/C0.A8.03.61 (192.168.3.97)
@ 820
FFFF FFFF FFFF A3C2
C700 1232 0806 0001
0800 0604 0001 A3C2
C700 1232 C0A8 0361
FFFF FFFF FFFF C0A8

without error:
001E 0000 0000 0000
0000 0000 0000 0000
0000 0003 2100 0000 011 0

PING request:
@ 830
0022 8F02 41EE A3C2
C700 1232 0800 4500
003c 2f46 0000 8001
0000 c0a8 0361 c0a8
001e 0800 4d53 0001
0008 6162 6364 6566
6768 696a 6b6c 6d6e
6f70 7172 7374 7576
7761 6263 6465 6667
6869 0000 0000 0000 110 0

% IP packet: UDP data from port a191 to port 0001
@ 945
0022 8F02 41EE A3C2
C700 1232 0800 4500
001d 093c 4000 8011
0000 c0a8 0361 c0a8
001e a191 0001 0044

0000 0809 1011 1213
1234 1234 1234 1234
2345 2345 2345 2345
3456 3456 3456 3456
4567 4567 4567 4567
5678 5678 5678 5678
6789 6789 6789 6789
7890 7890 7890 7890 100 0

% once we're here, we have basically tested enabled DHCP...
% let's just punch in again the very original ARP and PING requests
% for which we now don't expect any response

% ARP request by A3:C2:C7:00:12:32/C0.A8.03.61 (192.168.3.97)
@ 1020
FFFF FFFF FFFF A3C2
C700 1232 0806 0001
0800 0604 0001 A3C2
C700 1232 C0A8 0361
FFFF FFFF FFFF C0A8

without error:
0002 0000 0000 0000
0000 0000 0000 0000
0000 0003 2100 0000 011 0

PING request:
@ 1030
0022 8F02 41EE A3C2
C700 1232 0800 4500
003c 2f46 0000 8001
0000 c0a8 0361 c0a8
0002 0800 4d53 0001
0008 6162 6364 6566
6768 696a 6b6c 6d6e
6f70 7172 7374 7576
7761 6263 6465 6667
6869 0000 0000 0000 110 0

% and let's punch them through again, once DHCP is disabled again
% we'd now expect replies again

% ARP request by A3:C2:C7:00:12:32/C0.A8.03.61 (192.168.3.97)
@ 1220
FFFF FFFF FFFF A3C2
C700 1232 0806 0001
0800 0604 0001 A3C2
C700 1232 C0A8 0361
FFFF FFFF FFFF C0A8

without error:
0002 0000 0000 0000
0000 0000 0000 0000
0000 0003 2100 0000 011 0

PING request:
@ 1230
0022 8F02 41EE A3C2
C700 1232 0800 4500
003c 2f46 0000 8001
0000 c0a8 0361 c0a8
0002 0800 4d53 0001
0008 6162 6364 6566
6768 696a 6b6c 6d6e
6f70 7172 7374 7576
7761 6263 6465 6667
6869 0000 0000 0000 110 0
