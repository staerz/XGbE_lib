% comments:
% any line started with '%' - flag can be specified as generic in file_reader_hex
anything less than
length of a line
containing data

% interpreter ignores empty lines as well

% "@" is used to indicate counters for transmission start
% flag can be specified as generic in AV_ST_sender
% must be decimal numbers in increasing order!

% IP packet:
% IP src = C0A8 0101 (DHCP server 192.168.1.1)
% IP dst = FFFF FFFF (broadcast)
% IP length and IP CRC are usually wrong (not set) as it's not checked by the implementation

% UDP header:
% xxxx xxxx 0043 0044
% 011E 0000
% UDP length and CRC are usually wrong (not set) as it's not checked by the implementation

% actual DHCP data is everything from 0201 on

% DHCP Offer (35*8+6 bytes long = 286 = x11E)
@ 152

% IP header
4500 0133 093C 4000
8011 B811 C0A8 0101
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011F 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEEF 0000 0000
% CIADDR YIADDR
0000 0000 C0A8 0164
% SIADDR GIADDR
C0A8 0101 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP offer (3 + 1)
6382 5363 3501 0200
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
0104 FFFF FF00 0304
% IP lease time (6)
C0A8 0101 3304 0001
% DHCP server (6)
5180 3604 C0A8 0101
% DNS server (10)
0608 0102 0304 0102
0305 FFBA DBAD BADD 101 0

% DHCP Offer (35*8+6 bytes long = 286 = x11E)
% from another server
@ 220
% IP header
% IP length is not correct! (but that's ignored)
4500 0000 093C 4000
% IP checksum is also incorrect (but also ignored)
8011 0000 C0A8 0201
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011E 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEEF 0000 0000
% CIADDR YIADDR
0000 0000 C0A8 0234
% SIADDR GIADDR
C0A8 0201 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP offer (3 + 1)
6382 5363 3501 0200
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
0104 FFFF FF00 0304
% IP lease time (6)
C0A8 0201 3304 0001
% DHCP server (6)
5180 3604 C0A8 0201
% DNS server (10)
0608 0102 0304 0102
0305 FFBA DBAD BADD 101 0

% DHCP Acknowledge
@ 450
% IP header
4500 001D 093C 4000
8011 0000 C0A8 0101
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011E 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEEF 0000 0000
% CIADDR YIADDR
0000 0000 C0A8 0164
% SIADDR GIADDR
C0A8 0101 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP ackn (3 + 1)
6382 5363 3501 0500
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
0104 FFFF FF00 0304
% IP lease time (6)
C0A8 0101 3304 0000
% DHCP server (6)
0050 3604 C0A8 0101
% DNS server (10)
0608 0102 0304 0102
0305 FFBA DBAD BADD 101 0

% DHCP Acknowledge (on renewal request)
% to make it late, i.e. after RENEWING:
%@ 3300
% to make it too late, i.e. after REBINDING:
%@ 3658
@2142
% IP header
4500 001D 093C 4000
8011 0000 C0A8 0101
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011E 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEEF 0000 0000
% CIADDR YIADDR
0000 0000 C0A8 0164
% SIADDR GIADDR
C0A8 0101 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP ackn (3 + 1)
6382 5363 3501 0500
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
0104 FFFF FF00 0304
% IP lease time (6)
C0A8 0101 3304 0000
% DHCP server (6)
0050 3604 C0A8 0101
% DNS server (10)
0608 0102 0304 0102
0305 FFBA DBAD BADD 101 0

% DHCP Nacknowledge (on 2nd REBOOTING request)
% with ERROR! So it will be ignored.
% note that we currently also reset the file reader, so we can't reply earlier
@2500
% IP header
4500 001D 093C 4000
8011 0000 C0A8 0101
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011E 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEF0 0000 0000
% CIADDR YIADDR
0000 0000 0000 0000
% SIADDR GIADDR
0000 0000 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP nack (3 + 1)
6382 5363 3501 0600
% More DHCP options:
% DHCP server (6)
3604 C0A8 0101 FFBA 101 1
% the core should just ignore this package

% todo: fix description
% DHCP Acknowledge (on 2nd REBOOTING request)
% note that we currently also reset the file reader, so we can't reply earlier
@2600
% IP header
4500 001D 093C 4000
8011 0000 C0A8 0101
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011E 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEF0 0000 0000
% CIADDR YIADDR
0000 0000 C0A8 0164
% SIADDR GIADDR
C0A8 0101 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP ackn (3 + 1)
6382 5363 3501 0500
% More DHCP options:
% IP subnet mask (6) & Router IP (6)
0104 FFFF FF00 0304
% IP lease time (6)
C0A8 0101 3304 0000
% DHCP server (6)
0050 3604 C0A8 0101
% DNS server (10)
0608 0102 0304 0102
0305 FFBA DBAD BADD 101 0

% after this acknowledge, the core should go back to BOUND

% now reboot again but send a proper nack message

% DHCP Nacknowledge (on 2nd REBOOTING request)
% with ERROR! So it will be ignored.
% note that we currently also reset the file reader, so we can't reply earlier
@3100
% IP header
4500 001D 093C 4000
8011 0000 C0A8 0101
% UDP header: SRC DST length CRC
FFFF FFFF 0043 0044
011E 0000 0201 0600
% DHCP-header XID SECS FLAGS
DEAD BEF0 0000 0000
% CIADDR YIADDR
0000 0000 0000 0000
% SIADDR GIADDR
0000 0000 0000 0000
% CHADDR(1)
0022 8F02 41EE 0000
% CHADDR(2)
0000 0000 0000 0000
% SNAME(64 octets = 8 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% BNAME (128 octets = 16 rows)
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
0000 0000 0000 0000
% MAGIC_COOKIE DHCP nack (3 + 1)
6382 5363 3501 0600
% More DHCP options:
% DHCP server (6)
3604 C0A8 0101 FFBA 101 0

% after this nacknowledge, the core should go back to INIT/SELECTING
